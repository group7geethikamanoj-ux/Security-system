<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Denied History</title>
    <link rel="stylesheet" href="/static/style.css">
    <script src="/static/theme.js" defer></script>
</head>

<body>

<div class="navbar">
    <div class="nav-left">
        <div class="breadcrumb">
            <a href="/dashboard">Dashboard</a>
            <span>&gt;</span>
            <span>Denied History</span>
        </div>
    </div>

    <div class="nav-right">
        <a href="javascript:void(0)" class="logout" onclick="confirmLogout()">Logout</a>
    </div>
</div>

<div class="container">

    <h1>Denied / Blacklisted History</h1>

    <!-- SEARCH BAR -->
    <div class="search-bar">
        <input type="text" id="nameSearch" placeholder="Search by name..." onkeyup="filterTable()">
        <input type="text" id="dateSearch" placeholder="Search by date..." onkeyup="filterTable()">
    </div>

    {% if logs and logs|length > 0 %}

    <div class="table-wrapper">
    <table id="logTable">

        <thead>
            <tr>
                <th>Name</th>
                <th>Designation</th>
                <th>Blacklist</th>
                <th>Alcohol</th>
                <th>Mobile</th>
                <th>Face</th>
                <th>Status</th>
                <th>Timestamp</th>
            </tr>
        </thead>

        <tbody>
        {% for log in logs %}
            <tr>
                <td>{{ log.get('name','') }}</td>
                <td>{{ log.get('designation','') }}</td>
                <td>{{ log.get('blacklist_status','') }}</td>
                <td>{{ log.get('alcohol','') }}</td>
                <td>{{ log.get('mobile','') }}</td>
                <td>{{ log.get('face_status','') }}</td>

                <td>
                    <span class="badge danger">DENIED</span>
                </td>

                <td>{{ log.get('timestamp','') }}</td>
            </tr>
        {% endfor %}
        </tbody>

    </table>
    </div>

    {% else %}
        <p>No denied or blacklisted records found.</p>
    {% endif %}
</div>

<!-- FILTER SCRIPT -->
<script>
function filterTable() {
    let nameInput = document.getElementById("nameSearch").value.toLowerCase();
    let dateInput = document.getElementById("dateSearch").value.toLowerCase();

    let table = document.getElementById("logTable");
    let rows = table.getElementsByTagName("tr");

    for (let i = 1; i < rows.length; i++) {
        let nameCol = rows[i].cells[0].textContent.toLowerCase();
        let dateCol = rows[i].cells[7].textContent.toLowerCase();

        if (nameCol.includes(nameInput) && dateCol.includes(dateInput)) {
            rows[i].style.display = "";
        } else {
            rows[i].style.display = "none";
        }
    }
}
</script>

</body>
</html>
